-- SEIBro 2008-01-03 주가 정보 제공 시작일
SELECT * FROM STOCK_DIVIDEND_HISTORY WHERE BASE < '2008-01-03' AND DIVIDEND > 0
DELETE FROM STOCK_DIVIDEND_HISTORY WHERE BASE < '2008-01-03' AND DIVIDEND > 0
;

-- code가 어디선가 수집되었는데, 다른 정보를 가져오지 못하는 자료 삭제
SELECT *	FROM STOCK_ITEM WHERE SYMBOL IS NULL AND IPO_OPEN IS NULL
DELETE		FROM STOCK_ITEM WHERE SYMBOL IS NULL AND IPO_OPEN IS NULL
;

SELECT *	FROM STOCK_DIVIDEND_HISTORY	WHERE CODE IN (SELECT CODE FROM STOCK_ITEM WHERE SYMBOL IS NULL AND IPO_OPEN IS NULL)
DELETE		FROM STOCK_DIVIDEND_HISTORY	WHERE CODE IN (SELECT CODE FROM STOCK_ITEM WHERE SYMBOL IS NULL AND IPO_OPEN IS NULL)

SELECT *	FROM STOCK_PRICE  WHERE CODE IN (SELECT CODE FROM STOCK_ITEM WHERE SYMBOL IS NULL AND IPO_OPEN IS NULL)
DELETE		FROM STOCK_PRICE WHERE CODE IN (SELECT CODE FROM STOCK_ITEM WHERE SYMBOL IS NULL AND IPO_OPEN IS NULL)

SELECT *	FROM STOCK_ITEM WHERE SYMBOL IS NULL AND IPO_OPEN IS NULL
DELETE		FROM STOCK_ITEM WHERE SYMBOL IS NULL AND IPO_OPEN IS NULL
;

-- invalid 종목 삭제 ex) 003600
SELECT *	FROM STOCK_DIVIDEND_HISTORY	WHERE CODE = '003600'
DELETE		FROM STOCK_DIVIDEND_HISTORY	WHERE CODE = '003600'

SELECT *	FROM STOCK_PRICE  WHERE CODE = '003600'
DELETE		FROM STOCK_PRICE WHERE CODE = '003600'

SELECT *	FROM STOCK_ITEM WHERE CODE = '003600'
DELETE		FROM STOCK_ITEM WHERE CODE = '003600'
